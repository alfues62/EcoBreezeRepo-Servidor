
-- 5. Insertar un sensor
INSERT INTO SENSOR (MAC, USUARIO_ID) 
VALUES ('00:1A:2B:sasdaasdada', 12);  -- USUARIO_ID debe existir.

-- 6. Verificar el SensorID recién insertado
SELECT * FROM SENSOR;  -- Asegúrate de que el SensorID sea correcto.

-- 7. Insertar una medición
INSERT INTO `EcoBreeze`.`MEDICION` (`Valor`, `Lon`, `Lat`, `Fecha`, `Hora`, `TIPOGAS_TipoID`, `SENSOR_ID_Sensor`)
VALUES
-- Ozono (TIPOGAS_TipoID = 4)
(0.03, '-0.3758', '39.4702', '2024-1-12', '10:00:00', 2,4),
(0.05, '-0.3758', '39.4702', '2024-1-2', '10:30:00', 2,4),
(0.07, '-0.3758', '39.4702', '2024-4-4', '11:00:00', 2,4);


DELETE FROM USUARIO WHERE id=12;

DELIMITER //

CREATE TRIGGER asignar_categoria 
BEFORE INSERT ON MEDICION
FOR EACH ROW
BEGIN
    DECLARE categoria VARCHAR(45);

    -- Asignar la categoría basada en el tipo de gas y el valor de la medición
    SELECT Categoria INTO categoria
    FROM UMBRAL
    WHERE TIPOGAS_TipoID = NEW.TIPOGAS_TipoID
      AND NEW.Valor <= ValorUmbral
    ORDER BY ValorUmbral DESC
    LIMIT 1;

    -- Asignar la categoría encontrada a la nueva medición
    SET NEW.Categoria = categoria;
END//

DELIMITER ;

INSERT INTO `EcoBreeze`.`MEDICION` (`Valor`, `Lon`, `Lat`, `Fecha`, `Hora`, `TIPOGAS_TipoID`, `SENSOR_ID_Sensor`)
VALUES
-- Ozono (TIPOGAS_TipoID = 4)
(0.03, '-0.3758', '39.4702', '2024-11-21', '10:00:00', 2,13),
(0.05, '-0.3758', '39.4702', '2024-11-21', '10:30:00', 2,13),
(0.07, '-0.3758', '39.4702', '2024-11-23', '11:00:00', 2,13),
(0.1, '-0.3758', '39.4702', '2024-11-21', '11:30:00', 2,13),
(0.12, '-0.3758', '39.4702', '2024-11-22', '12:00:00', 2,13),
(0.08, '-0.3758', '39.4702', '2024-11-21', '12:30:00', 2,13),
(0.09, '-0.3758', '39.4702', '2024-11-28', '13:00:00', 2,13),
(0.06, '-0.3758', '39.4702', '2024-11-20', '13:30:00', 2,13),
(0.11, '-0.3758', '39.4702', '2024-11-20', '14:00:00', 2,13),

-- Monóxido de carbono (TIPOGAS_TipoID = 5)
(1.2, '-0.3758', '39.4702', '2024-11-20', '10:00:00', 3, 13),
(2.0, '-0.3758', '39.4702', '2024-11-21', '10:30:00', 3, 13),
(3.5, '-0.3758', '39.4702', '2024-11-23', '11:00:00', 3, 13),
(4.0, '-0.3758', '39.4702', '2024-11-23', '11:30:00', 3, 13),
(5.1, '-0.3758', '39.4702', '2024-11-21', '12:00:00', 3, 13),
(2.5, '-0.3758', '39.4702', '2024-11-23', '12:30:00', 3, 13),
(3.0, '-0.3758', '39.4702', '2024-11-23', '13:00:00', 3, 13),
(3.8, '-0.3758', '39.4702', '2024-11-21', '13:30:00', 3, 13),
(4.5, '-0.3758', '39.4702', '2024-11-20', '14:00:00', 3, 13),

-- Dióxido de nitrógeno (TIPOGAS_TipoID = 6)
(0.015, '-0.3758', '39.4702', '2024-11-21', '10:00:00', 4, 13),
(0.025, '-0.3758', '39.4702', '2024-11-22', '10:30:00', 4, 13),
(0.035, '-0.3758', '39.4702', '2024-11-21', '11:00:00', 4, 13),
(0.05, '-0.3758', '39.4702', '2024-11-22', '11:30:00', 4, 13),
(0.075, '-0.3758', '39.4702', '2024-11-21', '12:00:00', 4, 13),
(0.045, '-0.3758', '39.4702', '2024-11-22', '12:30:00', 4, 13),
(0.055, '-0.3758', '39.4702', '2024-11-23', '13:00:00', 4, 13),
(0.065, '-0.3758', '39.4702', '2024-11-23', '13:30:00', 4, 13),
(0.08, '-0.3758', '39.4702', '2024-11-21', '14:00:00', 4, 13),

-- Dióxido de azufre (TIPOGAS_TipoID = 7)
(0.005, '-0.3758', '39.4702', '2024-11-21', '10:00:00', 5, 13),
(0.01, '-0.3758', '39.4702', '2024-11-21', '10:30:00', 5, 13),
(0.02, '-0.3758', '39.4702', '2024-11-21', '11:00:00', 5, 13),
(0.03, '-0.3758', '39.4702', '2024-11-23', '11:30:00', 5, 13),
(0.04, '-0.3758', '39.4702', '2024-11-23', '12:00:00', 5, 13),
(0.025, '-0.3758', '39.4702', '2024-11-21', '12:30:00', 5, 13),
(0.035, '-0.3758', '39.4702', '2024-11-23', '13:00:00', 5, 13),
(0.045, '-0.3758', '39.4702', '2024-11-21', '13:30:00', 5, 13),
(0.05, '-0.3758', '39.4702', '2024-11-21', '14:00:00', 5, 13);



