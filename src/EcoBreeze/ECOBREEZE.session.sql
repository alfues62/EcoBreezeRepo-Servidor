
-- 5. Insertar un sensor
INSERT INTO SENSOR (MAC, USUARIO_ID) 
VALUES ('00:1A:2B:sasdaasdada', 1);  -- USUARIO_ID debe existir.
VALUES ('00:1A:2B:sasdaasdada', 1);  -- USUARIO_ID debe existir.

-- 6. Verificar el SensorID recién insertado
SELECT * FROM MEDICION ;  -- Asegúrate de que el SensorID sea correcto.

-- 7. Insertar una medición
INSERT INTO `EcoBreeze`.`MEDICION` (`Valor`, `Lon`, `Lat`, `Fecha`, `Hora`, `TIPOGAS_TipoID`, `SENSOR_ID_Sensor`)
VALUES
-- Ozono (TIPOGAS_TipoID = 4)
(0.03, '-0.3758', '39.4702', '2024-1-12', '10:00:00', 2,4),
(0.05, '-0.3758', '39.4702', '2024-1-2', '10:30:00', 2,4),
(0.07, '-0.3758', '39.4702', '2024-4-4', '11:00:00', 2,4);


DELETE FROM USUARIO WHERE id=12;

DELIMITER //

CREATE TRIGGER asignar_categoria 
BEFORE INSERT ON MEDICION
FOR EACH ROW
BEGIN
    DECLARE categoria VARCHAR(45);

    -- Asignar la categoría basada en el tipo de gas y el valor de la medición
    SELECT Categoria INTO categoria
    FROM UMBRAL
    WHERE TIPOGAS_TipoID = NEW.TIPOGAS_TipoID
      AND NEW.Valor <= ValorUmbral
    ORDER BY ValorUmbral DESC
    LIMIT 1;

    -- Asignar la categoría encontrada a la nueva medición
    SET NEW.Categoria = categoria;
END//

DELIMITER ;

INSERT INTO `EcoBreeze`.`MEDICION` (`Valor`, `Lon`, `Lat`, `Fecha`, `Hora`, `TIPOGAS_TipoID`, `SENSOR_ID_Sensor`)
VALUES
-- Ozono (TIPOGAS_TipoID = 4)
(0.03, '-0.3712', '39.4832', '2024-11-21', '10:00:00', 2, 2),
(0.05, '-0.3115', '39.4521', '2024-11-21', '10:30:00', 2, 2),
(0.07, '-0.3310', '39.4874', '2024-11-23', '11:00:00', 2, 2),
(0.1, '-0.4224', '39.4855', '2024-11-21', '11:30:00', 2, 2),
(0.12, '-0.3548', '39.4722', '2024-11-22', '12:00:00', 2, 2),
(0.08, '-0.3152', '39.4658', '2024-11-21', '12:30:00', 2, 2),
(0.09, '-0.3906', '39.4893', '2024-11-28', '13:00:00', 2, 2),
(0.06, '-0.3724', '39.4895', '2024-11-20', '13:30:00', 2, 2),
(0.11, '-0.3307', '39.4770', '2024-11-20', '14:00:00', 2, 2),

-- Monóxido de carbono (TIPOGAS_TipoID = 5)
(1.2, '-0.3857', '39.4771', '2024-11-20', '10:00:00', 3, 2),
(2.0, '-0.3604', '39.4693', '2024-11-21', '10:30:00', 3, 2),
(3.5, '-0.3381', '39.4856', '2024-11-23', '11:00:00', 3, 2),
(4.0, '-0.3552', '39.4530', '2024-11-23', '11:30:00', 3, 2),
(5.1, '-0.3085', '39.4782', '2024-11-21', '12:00:00', 3, 2),
(2.5, '-0.3239', '39.4677', '2024-11-23', '12:30:00', 3, 2),
(3.0, '-0.3793', '39.4761', '2024-11-23', '13:00:00', 3, 2),
(3.8, '-0.3583', '39.4705', '2024-11-21', '13:30:00', 3, 2),
(4.5, '-0.3157', '39.4613', '2024-11-20', '14:00:00', 3, 2),

-- Dióxido de nitrógeno (TIPOGAS_TipoID = 6)
(0.015, '-0.3589', '39.4910', '2024-11-21', '10:00:00', 4, 2),
(0.025, '-0.3772', '39.4652', '2024-11-22', '10:30:00', 4, 2),
(0.035, '-0.3950', '39.4725', '2024-11-21', '11:00:00', 4, 2),
(0.05, '-0.3325', '39.4907', '2024-11-22', '11:30:00', 4, 2),
(0.075, '-0.3202', '39.4569', '2024-11-21', '12:00:00', 4, 2),
(0.045, '-0.3845', '39.4741', '2024-11-22', '12:30:00', 4, 2),
(0.055, '-0.3567', '39.4892', '2024-11-23', '13:00:00', 4, 2),
(0.065, '-0.3409', '39.4653', '2024-11-23', '13:30:00', 4, 2),
(0.08, '-0.3550', '39.4570', '2024-11-21', '14:00:00', 4, 2),

-- Dióxido de azufre (TIPOGAS_TipoID = 7)
(0.005, '-0.3479', '39.4654', '2024-11-21', '10:00:00', 5, 2),
(0.01, '-0.3684', '39.4731', '2024-11-21', '10:30:00', 5, 2),
(0.02, '-0.3511', '39.4525', '2024-11-21', '11:00:00', 5, 2),
(0.03, '-0.3669', '39.4870', '2024-11-23', '11:30:00', 5, 2),
(0.04, '-0.3553', '39.4647', '2024-11-23', '12:00:00', 5, 2),
(0.025, '-0.3598', '39.4672', '2024-11-21', '12:30:00', 5, 2),
(0.035, '-0.3742', '39.4906', '2024-11-23', '13:00:00', 5, 2),
(0.045, '-0.3665', '39.4748', '2024-11-21', '13:30:00', 5, 2),
(0.05, '-0.3530', '39.4634', '2024-11-21', '14:00:00', 5, 2);



