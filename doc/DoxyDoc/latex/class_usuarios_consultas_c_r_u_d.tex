\doxysection{Usuarios\+Consultas\+CRUD Class Reference}
\hypertarget{class_usuarios_consultas_c_r_u_d}{}\label{class_usuarios_consultas_c_r_u_d}\index{UsuariosConsultasCRUD@{UsuariosConsultasCRUD}}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{class_usuarios_consultas_c_r_u_d_acfd6f7da68d2d55ff1fe93fbd8c72490}\label{class_usuarios_consultas_c_r_u_d_acfd6f7da68d2d55ff1fe93fbd8c72490} 
{\bfseries \+\_\+\+\_\+construct} (\$conn)
\item 
\mbox{\hyperlink{class_usuarios_consultas_c_r_u_d_ae2d3ae0f6bc1255938b2e69de99ad5cd}{login}} (\$email, \$contrasena)
\item 
\mbox{\hyperlink{class_usuarios_consultas_c_r_u_d_adde44442195852d0ed28080eae8b6971}{login\+Huella}} (\$email, \$token\+\_\+huella)
\item 
\mbox{\hyperlink{class_usuarios_consultas_c_r_u_d_a37273ab7d635e217a4e5c45554365953}{obtener\+Huella}} (\$email)
\item 
\mbox{\hyperlink{class_usuarios_consultas_c_r_u_d_a181702cfd7cea62bd2517991f4d8e859}{obtener\+Ultima\+Medicion\+De\+Usuarios\+Rol2}} ()
\item 
\mbox{\hyperlink{class_usuarios_consultas_c_r_u_d_a6767039e29021401063afb3905ca051f}{email\+Existente}} (\$email)
\item 
\mbox{\hyperlink{class_usuarios_consultas_c_r_u_d_a405180cfb0639f4a6e248fffa075a327}{obtener\+Datos\+Usuario\+Por\+ID}} (\$id)
\item 
\mbox{\hyperlink{class_usuarios_consultas_c_r_u_d_aed60ca5804d3a954c44d94abd1ce89cd}{verificar\+Token\+Valido}} (\$email, \$token)
\end{DoxyCompactItemize}


\doxysubsection{Member Function Documentation}
\Hypertarget{class_usuarios_consultas_c_r_u_d_a6767039e29021401063afb3905ca051f}\index{UsuariosConsultasCRUD@{UsuariosConsultasCRUD}!emailExistente@{emailExistente}}
\index{emailExistente@{emailExistente}!UsuariosConsultasCRUD@{UsuariosConsultasCRUD}}
\doxysubsubsection{\texorpdfstring{emailExistente()}{emailExistente()}}
{\footnotesize\ttfamily \label{class_usuarios_consultas_c_r_u_d_a6767039e29021401063afb3905ca051f} 
Usuarios\+Consultas\+CRUD\+::email\+Existente (\begin{DoxyParamCaption}\item[{}]{\$email}{}\end{DoxyParamCaption})}

Verifica si el email ya está registrado en la base de datos.

Este método consulta la base de datos para verificar si un correo electrónico ya existe en la tabla {\ttfamily USUARIO}. Retorna un valor booleano indicando si el email está registrado o no.

Diseño\+:

Entrada\+:
\begin{DoxyItemize}
\item {\ttfamily \$email}\+: El correo electrónico a verificar en la base de datos. Proceso\+:
\end{DoxyItemize}
\begin{DoxyEnumerate}
\item Realiza una consulta SQL que cuenta las filas donde el correo electrónico coincide con el proporcionado.
\item Si el resultado es mayor que 0, significa que el email ya está registrado.
\end{DoxyEnumerate}

Salida\+:
\begin{DoxyItemize}
\item {\ttfamily true}\+: Si el correo electrónico ya está registrado.
\item {\ttfamily false}\+: Si no está registrado o si ocurre un error en la consulta.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
string & {\em \$email} & El correo electrónico que se desea verificar. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bool {\ttfamily true} si el correo electrónico está registrado, {\ttfamily false} si no lo está o si hay un error. 
\end{DoxyReturn}
\Hypertarget{class_usuarios_consultas_c_r_u_d_ae2d3ae0f6bc1255938b2e69de99ad5cd}\index{UsuariosConsultasCRUD@{UsuariosConsultasCRUD}!login@{login}}
\index{login@{login}!UsuariosConsultasCRUD@{UsuariosConsultasCRUD}}
\doxysubsubsection{\texorpdfstring{login()}{login()}}
{\footnotesize\ttfamily \label{class_usuarios_consultas_c_r_u_d_ae2d3ae0f6bc1255938b2e69de99ad5cd} 
Usuarios\+Consultas\+CRUD\+::login (\begin{DoxyParamCaption}\item[{}]{\$email}{, }\item[{}]{\$contrasena}{}\end{DoxyParamCaption})}

Realiza el proceso de login verificando las credenciales del usuario.

Este método permite que un usuario se loguee proporcionando su email y contraseña. Se verifica que el email esté registrado, que el usuario esté verificado, y que la contraseña sea correcta. Si el usuario no está verificado, se comprobará si su token ha expirado. Si el token ha expirado, se eliminará al usuario de la base de datos. En caso de éxito, se devolverán los datos del usuario.

Diseño\+:

Entrada\+:
\begin{DoxyItemize}
\item email (string, el correo electrónico del usuario).
\item contrasena (string, la contraseña ingresada por el usuario).
\end{DoxyItemize}

Proceso\+:
\begin{DoxyEnumerate}
\item Verificar si el email está registrado en la base de datos.
\item Si el usuario no está verificado, comprobar si el token de verificación ha expirado.
\item Si el token ha expirado, eliminar al usuario de la base de datos.
\item Si el usuario está verificado, verificar la contraseña utilizando {\ttfamily password\+\_\+verify}.
\item Si las credenciales son correctas, devolver los datos del usuario (ID, Nombre, Apellidos, Rol).
\item Si las credenciales son incorrectas, devolver un mensaje de error.
\end{DoxyEnumerate}

Salida\+:
\begin{DoxyItemize}
\item En caso de éxito\+: \{ "{}success"{}\+: true, "{}data"{}\+: \{ "{}\+ID"{}\+: "{}usuario\+\_\+id"{}, "{}\+Nombre"{}\+: "{}usuario\+\_\+nombre"{}, "{}\+Apellidos"{}\+: "{}usuario\+\_\+apellidos"{}, "{}\+Rol"{}\+: "{}usuario\+\_\+rol"{} \} \}
\item En caso de error\+: \{ "{}success"{}\+: false, "{}error"{}\+: "{}\+Mensaje de error específico"{} \}
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
string & {\em \$email} & El correo electrónico del usuario. \\
\hline
string & {\em \$contrasena} & La contraseña ingresada por el usuario. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
array Un array con el resultado de la autenticación. 
\end{DoxyReturn}
\Hypertarget{class_usuarios_consultas_c_r_u_d_adde44442195852d0ed28080eae8b6971}\index{UsuariosConsultasCRUD@{UsuariosConsultasCRUD}!loginHuella@{loginHuella}}
\index{loginHuella@{loginHuella}!UsuariosConsultasCRUD@{UsuariosConsultasCRUD}}
\doxysubsubsection{\texorpdfstring{loginHuella()}{loginHuella()}}
{\footnotesize\ttfamily \label{class_usuarios_consultas_c_r_u_d_adde44442195852d0ed28080eae8b6971} 
Usuarios\+Consultas\+CRUD\+::login\+Huella (\begin{DoxyParamCaption}\item[{}]{\$email}{, }\item[{}]{\$token\+\_\+huella}{}\end{DoxyParamCaption})}

Realiza el login mediante el token de huella y el correo electrónico del usuario.

Este método permite que un usuario inicie sesión utilizando su correo electrónico y el token de huella previamente registrado en la base de datos. Se verifica que el correo electrónico y el token de huella coincidan en la base de datos. Si las credenciales son correctas, se devuelven los datos del usuario; de lo contrario, se devuelve un mensaje de error.

Diseño\+:

Entrada\+:
\begin{DoxyItemize}
\item email (string, el correo electrónico del usuario).
\item token\+\_\+huella (string, el token de huella proporcionado por el usuario).
\end{DoxyItemize}

Proceso\+:
\begin{DoxyEnumerate}
\item Verificar si el correo electrónico y el token de huella coinciden en la base de datos.
\item Si no se encuentra una coincidencia, devolver un mensaje de error indicando que el token o el correo es inválido.
\item Si la coincidencia es exitosa, devolver los datos del usuario (ID, Nombre, Rol).
\end{DoxyEnumerate}

Salida\+:
\begin{DoxyItemize}
\item En caso de éxito\+: \{ "{}success"{}\+: true, "{}data"{}\+: \{ "{}\+ID"{}\+: "{}usuario\+\_\+id"{}, "{}\+Nombre"{}\+: "{}usuario\+\_\+nombre"{}, "{}\+Rol"{}\+: "{}usuario\+\_\+rol"{} \} \}
\item En caso de error\+: \{ "{}success"{}\+: false, "{}error"{}\+: "{}\+Token de huella o correo electrónico inválido"{} \}
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
string & {\em \$email} & El correo electrónico del usuario. \\
\hline
string & {\em \$token\+\_\+huella} & El token de huella proporcionado por el usuario. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
array Un array con el resultado de la autenticación. 
\end{DoxyReturn}
\Hypertarget{class_usuarios_consultas_c_r_u_d_a405180cfb0639f4a6e248fffa075a327}\index{UsuariosConsultasCRUD@{UsuariosConsultasCRUD}!obtenerDatosUsuarioPorID@{obtenerDatosUsuarioPorID}}
\index{obtenerDatosUsuarioPorID@{obtenerDatosUsuarioPorID}!UsuariosConsultasCRUD@{UsuariosConsultasCRUD}}
\doxysubsubsection{\texorpdfstring{obtenerDatosUsuarioPorID()}{obtenerDatosUsuarioPorID()}}
{\footnotesize\ttfamily \label{class_usuarios_consultas_c_r_u_d_a405180cfb0639f4a6e248fffa075a327} 
Usuarios\+Consultas\+CRUD\+::obtener\+Datos\+Usuario\+Por\+ID (\begin{DoxyParamCaption}\item[{}]{\$id}{}\end{DoxyParamCaption})}

Obtiene los datos de un usuario por su ID.

Este método consulta la base de datos para obtener los detalles del usuario, como su ID, nombre, apellidos y correo electrónico, utilizando el ID proporcionado. Retorna un arreglo con los datos del usuario si existe, o un mensaje de error si no se encuentra.

Diseño\+:

Entrada\+:
\begin{DoxyItemize}
\item {\ttfamily \$id}\+: El ID del usuario cuyo datos se desean obtener. Proceso\+:
\end{DoxyItemize}
\begin{DoxyEnumerate}
\item Realiza una consulta SQL que busca el usuario por su ID.
\item Si el usuario existe, se obtiene su información.
\item Si no se encuentra el usuario, se devuelve un mensaje de error.
\end{DoxyEnumerate}

Salida\+:
\begin{DoxyItemize}
\item {\ttfamily success}\+: {\ttfamily true} si los datos del usuario fueron obtenidos correctamente.
\item {\ttfamily usuario}\+: Los datos del usuario si es encontrado.
\item {\ttfamily success}\+: {\ttfamily false} si el usuario no es encontrado o si ocurre un error.
\item {\ttfamily error}\+: Mensaje de error si no se encuentra el usuario o si ocurre un problema durante la consulta.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
int & {\em \$id} & El ID del usuario que se desea consultar. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
array Un arreglo que contiene el estado de la operación y los datos del usuario o el error correspondiente. 
\end{DoxyReturn}
\Hypertarget{class_usuarios_consultas_c_r_u_d_a37273ab7d635e217a4e5c45554365953}\index{UsuariosConsultasCRUD@{UsuariosConsultasCRUD}!obtenerHuella@{obtenerHuella}}
\index{obtenerHuella@{obtenerHuella}!UsuariosConsultasCRUD@{UsuariosConsultasCRUD}}
\doxysubsubsection{\texorpdfstring{obtenerHuella()}{obtenerHuella()}}
{\footnotesize\ttfamily \label{class_usuarios_consultas_c_r_u_d_a37273ab7d635e217a4e5c45554365953} 
Usuarios\+Consultas\+CRUD\+::obtener\+Huella (\begin{DoxyParamCaption}\item[{}]{\$email}{}\end{DoxyParamCaption})}

Obtiene el token de huella asociado a un correo electrónico.

Este método permite obtener el token de huella de un usuario a partir de su correo electrónico. Si el usuario existe y tiene un token de huella registrado, se devuelve dicho token. Si no se encuentra el usuario o no tiene un token de huella asociado, se devuelve {\ttfamily null}.

Diseño\+:

Entrada\+:
\begin{DoxyItemize}
\item email (string, el correo electrónico del usuario).
\end{DoxyItemize}

Proceso\+:
\begin{DoxyEnumerate}
\item Verificar si existe un registro de usuario con el correo electrónico proporcionado.
\item Si se encuentra el usuario, devolver el token de huella asociado.
\item Si no se encuentra el usuario, devolver {\ttfamily null}.
\end{DoxyEnumerate}

Salida\+:
\begin{DoxyItemize}
\item En caso de éxito, el token de huella del usuario.
\item En caso de error o si no se encuentra el usuario, {\ttfamily null}.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
string & {\em \$email} & El correo electrónico del usuario. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string\texorpdfstring{$\vert$}{|}null El token de huella del usuario o {\ttfamily null} si no se encuentra el usuario o no tiene un token de huella. 
\end{DoxyReturn}
\Hypertarget{class_usuarios_consultas_c_r_u_d_a181702cfd7cea62bd2517991f4d8e859}\index{UsuariosConsultasCRUD@{UsuariosConsultasCRUD}!obtenerUltimaMedicionDeUsuariosRol2@{obtenerUltimaMedicionDeUsuariosRol2}}
\index{obtenerUltimaMedicionDeUsuariosRol2@{obtenerUltimaMedicionDeUsuariosRol2}!UsuariosConsultasCRUD@{UsuariosConsultasCRUD}}
\doxysubsubsection{\texorpdfstring{obtenerUltimaMedicionDeUsuariosRol2()}{obtenerUltimaMedicionDeUsuariosRol2()}}
{\footnotesize\ttfamily \label{class_usuarios_consultas_c_r_u_d_a181702cfd7cea62bd2517991f4d8e859} 
Usuarios\+Consultas\+CRUD\+::obtener\+Ultima\+Medicion\+De\+Usuarios\+Rol2 (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}

Obtiene la última medición de todos los usuarios con rol 2.

Este método consulta la base de datos para obtener la última medición registrada para cada usuario con rol 2. La medición se obtiene a través de la relación entre las tablas {\ttfamily USUARIO}, {\ttfamily SENSOR} y {\ttfamily MEDICION}. Si un usuario no tiene ninguna medición, se asigna \textquotesingle{}N/A\textquotesingle{} como valor de su última medición.

Diseño\+:

Entrada\+: Ninguna. Proceso\+:
\begin{DoxyEnumerate}
\item Realiza una consulta SQL que obtiene la última medición de cada usuario con rol 2.
\item Si un usuario no tiene mediciones, su valor de última medición será \textquotesingle{}N/A\textquotesingle{}.
\item Se devuelve una lista de usuarios con su última medición, ordenada de más reciente a más antigua.
\end{DoxyEnumerate}

Salida\+:
\begin{DoxyItemize}
\item En caso de éxito, devuelve una lista de usuarios con sus respectivas últimas mediciones.
\item En caso de error, devuelve un mensaje de error detallado.
\end{DoxyItemize}

\begin{DoxyReturn}{Returns}
array El resultado de la consulta, con el estado de la operación y los datos obtenidos. 
\end{DoxyReturn}
\Hypertarget{class_usuarios_consultas_c_r_u_d_aed60ca5804d3a954c44d94abd1ce89cd}\index{UsuariosConsultasCRUD@{UsuariosConsultasCRUD}!verificarTokenValido@{verificarTokenValido}}
\index{verificarTokenValido@{verificarTokenValido}!UsuariosConsultasCRUD@{UsuariosConsultasCRUD}}
\doxysubsubsection{\texorpdfstring{verificarTokenValido()}{verificarTokenValido()}}
{\footnotesize\ttfamily \label{class_usuarios_consultas_c_r_u_d_aed60ca5804d3a954c44d94abd1ce89cd} 
Usuarios\+Consultas\+CRUD\+::verificar\+Token\+Valido (\begin{DoxyParamCaption}\item[{}]{\$email}{, }\item[{}]{\$token}{}\end{DoxyParamCaption})}

Verifica si el token de un usuario es válido y no ha expirado.

Este método realiza una serie de verificaciones para asegurar que el token proporcionado para un usuario es válido, no ha caducado, y corresponde al token almacenado en la base de datos. Si alguna de las verificaciones falla, se devuelve un mensaje de error adecuado. Si todas las verificaciones son satisfactorias, se devuelve un mensaje de éxito.

Diseño\+:

Entrada\+:
\begin{DoxyItemize}
\item {\ttfamily \$email}\+: El correo electrónico del usuario cuyo token se desea verificar.
\item {\ttfamily \$token}\+: El token proporcionado que se desea validar. Proceso\+:
\end{DoxyItemize}
\begin{DoxyEnumerate}
\item Realiza una consulta SQL para obtener el token y su fecha de expiración asociada al correo proporcionado.
\item Verifica si el token está presente, si coincide con el proporcionado y si no ha expirado.
\item Si el token es válido, retorna éxito. Si alguna verificación falla, retorna el error correspondiente.
\end{DoxyEnumerate}

Salida\+:
\begin{DoxyItemize}
\item {\ttfamily success}\+: {\ttfamily true} si el token es válido y no ha expirado.
\item {\ttfamily message}\+: Mensaje que indica que el token es válido si la verificación es exitosa.
\item {\ttfamily success}\+: {\ttfamily false} si el token es inválido, no coincide, o ha expirado.
\item {\ttfamily error}\+: Mensaje de error detallado si alguna verificación falla.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
string & {\em \$email} & El correo electrónico del usuario cuyo token se desea verificar. \\
\hline
string & {\em \$token} & El token proporcionado por el usuario para verificar su validez. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
array Un arreglo con el estado de la operación, ya sea éxito o error. 
\end{DoxyReturn}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
C\+:/\+GTI\+\_\+\+Carpeta/\+Biometria\+Repos/\+Eco\+Breeze\+Repo-\/\+Servidor/src/\+Eco\+Breeze/backend/controllers/usuario\+\_\+consultas\+\_\+\+CRUD.\+php\end{DoxyCompactItemize}
